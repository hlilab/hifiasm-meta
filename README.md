(WIP) A hifiasm fork (https://github.com/chhylp123/hifiasm) for metagenome assembly.

## Getting Started
```sh
# Install hifiasm-meta (g++ and zlib required)
git clone https://github.com/xfengnefx/hifiasm-meta.git
cd hifiasm-meta && make

# Run
hifiasm_meta -t32 --force-preovec --exp-graph-cleaning -oasm reads.fq.gz 2>asm.log

# (debug) to include previous commit ID to bin files
(after git commit, do)
./stamp.sh; make
```

## Current output files

Raw unitig graph: asm.r\_utg\*.gfa

Cleaned unitig graph: asm.p\_utg\*.gfa 

Contig graph (WIP): asm.p\_ctg\*.gfa

## Special Notes

IMPORTANT: some routines of the stable hifiasm might not present or are altered in this dev fork right now, even if you disable both read selection and experimental graph cleaning. 

Certain commits may write excessive info to STDERR for dev/debug purposes (even without -V), please pipe to gzip if this is a concern.

Bin file format has been slightly altered because of the need for auxiliary info etc, currently hifiasm-meta cannot use bin files generated by hifiasm, but the reverse should work. This is temporary. (To only enable read selection, do not set --exp-graph-cleaning, and set -S or --force-preovec; to only eanble experimental graph cleaning but keep all the reads, set --exp-graph-cleaning and -X.)

## Known issues & might not get a timely fix

--lowq-5/--lowq-3 are exposed but might have problem; please stick to using --lowq-10 or the default.

To fully disable read selection, you must specify -X (instead of simply omitting -S). This is due to some legacy routines and will be fixed later.

## Switches (see also README\_ha.md)

```
#Interface
-B		Name of bin files. Allows to use bin files from other 
       		directories (and write to the destination specified by -o). 
	        Use -o otherwise.

# Read selection
--preovec	Enable the current read selection strategy. Note that 
		if the total number of possible overlaps appears acceptable, 
		read selection will note be triggered. 
		To negate this check, use --force-preovec instead.
-X		Disable all read selection.
--force-preovec 	Force to do the read selection.
--preovec-coverage	Median kmer frequency threshold, runtime; semi deprecated. [150] 
--lowq-10		Lower 10% quantile kmer frequency threshold, runtime. [150]

# Graph cleaning
--exp-graph-cleaning	Enable experimental treatments (e.g. topo-aware coverage-based 
			arc drop). Basic routines are not affected by this switch.
```

